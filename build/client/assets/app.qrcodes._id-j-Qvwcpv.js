import{w as S,c as L,d as Q,u as q,r as o,b as D,e as P,f as T,j as e}from"./chunk-WWGJGFF6-C-7sk41n.js";const z=S(function(){var u;const g=L(),{id:f}=Q(),a=q(),[s,x]=o.useState(a),[t,n]=o.useState(a),m=((u=D())==null?void 0:u.errors)||{};P().state;const r=JSON.stringify(t)!==JSON.stringify(s);async function d(){var p,h;const i=await window.shopify.resourcePicker({type:"product",action:"select"});if(i){const{images:b,id:w,variants:C,title:I,handle:R}=i[0];n({...t,productId:w,productVariantId:C[0].id,productTitle:I,productHandle:R,productAlt:(p=b[0])==null?void 0:p.altText,productImage:(h=b[0])==null?void 0:h.originalSrc})}}function j(){n({title:t.title,destination:t.destination})}const c=t.productId?`shopify://admin/products/${t.productId.split("/").at(-1)}`:"",l=T();function k(){const i={title:t.title,productId:t.productId||"",productVariantId:t.productVariantId||"",productHandle:t.productHandle||"",destination:t.destination};l(i,{method:"post"})}function v(){l({action:"delete"},{method:"post"})}function y(){n(s),window.shopify.saveBar.hide("qr-code-form")}return o.useEffect(()=>(r?window.shopify.saveBar.show("qr-code-form"):window.shopify.saveBar.hide("qr-code-form"),()=>{window.shopify.saveBar.hide("qr-code-form")}),[r]),o.useEffect(()=>{x(a),n(a)},[f,a]),e.jsx(e.Fragment,{children:e.jsx("form",{"data-save-bar":!0,onSubmit:k,onReset:y,children:e.jsxs("s-page",{heading:s.title||"Create QR code",children:[e.jsx("s-link",{href:"/app",slot:"breadcrumb-actions",onClick:i=>r?i.preventDefault():g("/app/"),children:"QR Codes"}),s.id&&e.jsx("s-button",{slot:"secondary-actions",onClick:v,children:"Delete"}),e.jsx("s-section",{heading:"QR Code information",children:e.jsxs("s-stack",{gap:"base",children:[e.jsx("s-text-field",{label:"Title",details:"Only store staff can see this title",error:m.title,autoComplete:"off",name:"title",value:t.title,onInput:i=>n({...t,title:i.target.value})}),e.jsxs("s-stack",{gap:"500",align:"space-between",blockAlign:"start",children:[e.jsxs("s-select",{name:"destination",label:"Scan destination",value:t.destination,onChange:i=>n({...t,destination:i.target.value}),children:[e.jsx("s-option",{value:"product",selected:t.destination==="product",children:"Link to product page"}),e.jsx("s-option",{value:"cart",selected:t.destination==="cart",children:"Link to checkout page with product in the cart"})]}),s.destinationUrl?e.jsx("s-link",{variant:"plain",href:s.destinationUrl,target:"_blank",children:"Go to destination URL"}):null]}),e.jsxs("s-stack",{gap:"small-400",children:[e.jsxs("s-stack",{direction:"inline",gap:"small-100",justifyContent:"space-between",children:[e.jsx("s-text",{color:"subdued",children:"Product"}),t.productId?e.jsx("s-link",{onClick:j,accessibilityLabel:"Remove the product from this QR Code",variant:"tertiary",tone:"neutral",children:"Clear"}):null]}),t.productId?e.jsxs("s-stack",{direction:"inline",justifyContent:"space-between",alignItems:"center",children:[e.jsxs("s-stack",{direction:"inline",gap:"small-100",alignItems:"center",children:[e.jsx("s-clickable",{href:c,target:"_blank",accessibilityLabel:`Go to the product page for ${t.productTitle}`,borderRadius:"base",children:e.jsx("s-box",{padding:"small-200",border:"base",borderRadius:"base",background:"subdued",inlineSize:"38px",blockSize:"38px",children:t.productImage?e.jsx("s-image",{src:t.productImage}):e.jsx("s-icon",{size:"large",type:"product"})})}),e.jsx("s-link",{href:c,target:"_blank",children:t.productTitle})]}),e.jsx("s-stack",{direction:"inline",gap:"small",children:e.jsx("s-button",{onClick:d,accessibilityLabel:"Change the product the QR code should be for",children:"Change"})})]}):e.jsx("s-button",{onClick:d,accessibilityLabel:"Select the product the QR code should be for",children:"Select product"})]})]})}),e.jsx("s-box",{slot:"aside",children:e.jsx("s-section",{heading:"Preview",children:e.jsxs("s-stack",{gap:"base",children:[e.jsx("s-box",{padding:"base",border:"none",borderRadius:"base",background:"subdued",children:s.image?e.jsx("s-image",{aspectRatio:"1/0.8",src:s.image,alt:"The QR Code for the current form"}):e.jsx("s-stack",{direction:"inline",alignItems:"center",justifyContent:"center",blockSize:"198px",children:e.jsx("s-text",{color:"subdued",children:"See a preview once you save"})})}),e.jsxs("s-stack",{gap:"small",direction:"inline",alignItems:"center",justifyContent:"space-between",children:[e.jsx("s-button",{disabled:!s.id,href:`/qrcodes/${s.id}`,target:"_blank",children:"Go to public URL"}),e.jsx("s-button",{disabled:!(s!=null&&s.image),href:s==null?void 0:s.image,download:!0,variant:"primary",children:"Download"})]})]})})})]})})})});export{z as default};
